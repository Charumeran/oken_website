# お問い合わせフォーム バックエンドサーバー

株式会社櫻建のウェブサイト用お問い合わせフォームのバックエンドサーバーです。

## 機能

- お問い合わせフォームの受信
- 管理者へのメール転送
- お客様への自動返信メール送信
- フォームデータのバリデーション

## セットアップ

### 1. 依存関係のインストール

```bash
cd server
npm install
```

### 2. 環境変数の設定

`.env.example`をコピーして`.env`ファイルを作成し、必要な情報を設定してください。

```bash
cp .env.example .env
```

### 必要な環境変数

- `SMTP_HOST`: SMTPサーバーのホスト名
- `SMTP_PORT`: SMTPサーバーのポート番号
- `SMTP_USER`: SMTPサーバーのユーザー名（メールアドレス）
- `SMTP_PASS`: SMTPサーバーのパスワード（アプリパスワード）
- `ADMIN_EMAIL`: 管理者のメールアドレス（お問い合わせを受信するアドレス）
- `PORT`: サーバーのポート番号（デフォルト: 3000）

### Gmail の場合の設定

1. Googleアカウントで2段階認証を有効にする
2. アプリパスワードを生成する
   - Googleアカウント設定 → セキュリティ → 2段階認証プロセス → アプリパスワード
3. 生成されたパスワードを`SMTP_PASS`に設定する

## 起動方法

### 開発環境

```bash
npm run dev
```

### 本番環境

```bash
npm start
```

## API エンドポイント

### POST /api/contact

お問い合わせフォームを送信します。

#### リクエストボディ

```json
{
  "name": "山田太郎",
  "company": "株式会社サンプル",
  "email": "yamada@example.com",
  "phone": "090-1234-5678",
  "inquiry": ["足場工事", "見積もり"],
  "message": "お問い合わせ内容",
  "privacy_agree": "true"
}
```

#### レスポンス

成功時:
```json
{
  "success": true,
  "message": "お問い合わせを受け付けました。2営業日以内にご連絡いたします。"
}
```

エラー時:
```json
{
  "success": false,
  "message": "エラーメッセージ"
}
```

## フロントエンドとの連携

フロントエンドの`form.js`を更新して、このAPIエンドポイントにリクエストを送信するように設定してください。